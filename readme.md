No refactoring done. All code here is in its original form when the answer it gave was correct. It won't be efficient and parts won't be pretty
